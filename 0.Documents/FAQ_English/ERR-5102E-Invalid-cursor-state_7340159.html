<!DOCTYPE html>
<html>
    <head>
        <title>FAQ(English) : ERR-5102E Invalid cursor state</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">FAQ(English)</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home_6979649.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Altibase-Error-Messages_6979655.html">Altibase Error Messages</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            FAQ(English) : ERR-5102E Invalid cursor state
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
    
            Created by <span class='author'> Education/Contents Team</span>, last modified on Oct 28, 2014
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <style type='text/css'>/*<![CDATA[*/
div.rbtoc1624409152240 {padding: 0px;}
div.rbtoc1624409152240 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1624409152240 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1624409152240'>
<ul class='toc-indentation'>
<li><a href='#ERR-5102EInvalidcursorstate-Version'>Version</a></li>
<li><a href='#ERR-5102EInvalidcursorstate-Explanation'>Explanation</a></li>
<li><a href='#ERR-5102EInvalidcursorstate-Cause'>Cause</a></li>
<li><a href='#ERR-5102EInvalidcursorstate-Action'>Action</a></li>
<li><a href='#ERR-5102EInvalidcursorstate-Reference'>Reference</a></li>
</ul>
</div>


<h2 id="ERR-5102EInvalidcursorstate-Version">Version</h2>

<p>5.1.1 or above.</p>


<h2 id="ERR-5102EInvalidcursorstate-Explanation">Explanation</h2>

<p>Unable to use cursor or execute the SELECT statement using cursors in the application.</p>
















<h2 id="ERR-5102EInvalidcursorstate-Cause">Cause</h2>

<p>This error can occur:</p>
<ul>
	<li>when trying to open the cursor without closing the cursor that has been used.</li>
	<li>when trying to fetch the committed cursor. </li>
	<li>if the application's cursor calling order is incorrect.</li>
	<li>due to a concurrency control issue if a single connection is shared in a multithreaded environment. </li>
</ul>











<h2 id="ERR-5102EInvalidcursorstate-Action">Action</h2>

<p>Sometimes, when the user program is found to be a thread, there is a possibility of handling an invalid cursor from its own thread because concurrency control of the connection object is not performed properly. Thus, the CLOSE CURSOR clause has to be used whenever finishing using a cursor to resolve the problem.</p>
<div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>DECLARE CURSOR</p>

<p>OPEN CURSOR</p>

<p>FETCH CURSOR</p>

<p>/<strong>* CLOSE CURSOR *</strong>/  This clause is missing in most of the cases.</p>
</div></div>
<p>1. Fix CURSOR DECLARE/OPEN/FETCH/CLOSE errors. </p>

<p>2. If the connection is being shared in a multithreaded environment, output thread numbers to check the cursor calling order.</p>

<p>3. If thread concurrency cannot be controlled in the application, give each thread a connection.</p>

<h2 id="ERR-5102EInvalidcursorstate-Reference">Reference</h2>

<p>This error can occur after a version upgrade to ALTIBASE HDB 5.1.1 or above. </p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 23, 2021 09:45</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
