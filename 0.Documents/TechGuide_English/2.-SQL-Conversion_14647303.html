<!DOCTYPE html>
<html>
    <head>
        <title>Technical Documents(English) : 2. SQL Conversion</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Technical Documents(English)</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home_557064.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="MSSQL-to-ALTIBASE-Conversion-Guide_14647299.html">MSSQL to ALTIBASE Conversion Guide</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Technical Documents(English) : 2. SQL Conversion
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
    
            Created by <span class='author'> richard.nahm	</span>, last modified on Feb 18, 2021
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="id-2.SQLConversion-/*&lt;![CDATA[*/div.rbtoc1624409360463{padding:0px;}div.rbtoc1624409360463ul{list-style:disc;margin-left:0px;}div.rbtoc1624409360463li{margin-left:0px;padding-left:0px;}/*]]&gt;*/#id-2.SQLConversion-SQLConversion#id-2.SQLConversion-SQLConvers"><strong><style type='text/css'>/*<![CDATA[*/
div.rbtoc1624409360463 {padding: 0px;}
div.rbtoc1624409360463 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1624409360463 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1624409360463'>
<ul class='toc-indentation'>
<li><a href='#id-2.SQLConversion-'></a></li>
<li><a href='#id-2.SQLConversion-SQLConversion'>SQL Conversion</a>
<ul class='toc-indentation'>
<li><a href='#id-2.SQLConversion-1.JOIN'>1. JOIN</a></li>
<li><a href='#id-2.SQLConversion-2.ExecutionQuery'>2. Execution Query</a></li>
<li><a href='#id-2.SQLConversion-3.TemporaryTable'>3. Temporary Table</a></li>
<li><a href='#id-2.SQLConversion-4.ControlStatement'>4. Control Statement</a></li>
<li><a href='#id-2.SQLConversion-5.Identityattribute'>5. Identity attribute</a></li>
<li><a href='#id-2.SQLConversion-6.ProcedureConversion'>6. Procedure Conversion</a>
<ul class='toc-indentation'>
<li><a href='#id-2.SQLConversion-1.ParameterDeclaration'>1. Parameter Declaration</a></li>
<li><a href='#id-2.SQLConversion-2.VariableDeclaration'>2. Variable Declaration</a></li>
<li><a href='#id-2.SQLConversion-3.ASSIGNMENT'>3. ASSIGNMENT</a></li>
<li><a href='#id-2.SQLConversion-4.Control_flow–IFStatement'>4. Control_flow – IF Statement</a></li>
<li><a href='#id-2.SQLConversion-5.SELECTStatement'>5. SELECT Statement</a></li>
<li><a href='#id-2.SQLConversion-6.ExceptionHandler'>6. Exception Handler</a></li>
<li><a href='#id-2.SQLConversion-7.SPCall'>7. SP Call</a></li>
<li><a href='#id-2.SQLConversion-8.Functions'>8. Functions</a></li>
<li><a href='#id-2.SQLConversion-9.Etc'>9. Etc</a></li>
<li><a href='#id-2.SQLConversion-10.DBLink'>10. DB Link</a></li>
<li><a href='#id-2.SQLConversion-11.JOINUPDATE'>11. JOIN UPDATE</a></li>
</ul>
</li>
<li><a href='#id-2.SQLConversion-7.UsingCursor'>7. Using Cursor</a></li>
</ul>
</li>
<li><a href='#id-2.SQLConversion-EXCEPTIONCODE'>EXCEPTION CODE</a></li>
</ul>
</div><br /></strong></h2><h2 id="id-2.SQLConversion-SQLConversion"><strong>SQL Conversion</strong></h2><div>This chapter describes how to convert SQL statements from SQL Server to ATLIBASE.</div><div><h3 id="id-2.SQLConversion-1.JOIN">1. JOIN</h3><div><hr /><p>ALTIBASE provides only ANSI standard JOIN operation.</p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>SQL Server</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>ALTIBASE</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p>REMARK</p></div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>INNER JOIN</p></td><td class="confluenceTd"><p>INNER JOIN</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>LEFT OUTER JOIN</p></td><td class="confluenceTd"><p>LEFT OUTER JOIN</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>RIGHT OUTER JOIN</p></td><td class="confluenceTd"><p>RIGHT OUTER JOIN</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>FULL OUTER JOIN</p></td><td class="confluenceTd"><p>FULL OUTER JOIN</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>CROSS JOIN</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr></tbody></table></div><h3 id="id-2.SQLConversion-2.ExecutionQuery">2. Execution Query</h3><hr />The query terminating character of ALTIBASE is “;” to be. Therefore, if the user wants to execute multiple queries at once, the user must separate each query with the terminator &quot;;&quot;.<div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>SQL Server</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>ALTIBASE</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p>REMARK</p></div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>GO</p></td><td class="confluenceTd"><p>;<br class="atl-forced-newline" />Commit;</p></td><td class="confluenceTd"><p>Default value: Autocommit</p></td></tr></tbody></table></div><h3 id="id-2.SQLConversion-3.TemporaryTable">3. Temporary Table</h3><hr /><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>SQL Server</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>ALTIBASE</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p>REMARK</p></div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>CREATE TABLE #TempProcess</p></td><td class="confluenceTd"><p>CREATE TABLE TEMP1 (…) TABLESPACE volatile_tablespace_name</p></td></tr></tbody></table></div><h3 id="id-2.SQLConversion-4.ControlStatement">4. Control Statement</h3><hr /><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong> </strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>SQL Server</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>ALTIBASE</strong></p></div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>IF</p></td><td class="confluenceTd"><p>If (Condition)<br class="atl-forced-newline" />Else if (Condition)<br class="atl-forced-newline" />Else<br class="atl-forced-newline" />End</p></td><td class="confluenceTd"><p>If condition then<br class="atl-forced-newline" />Elseif condition then<br class="atl-forced-newline" />Else<br class="atl-forced-newline" />End</p></td></tr><tr><td class="confluenceTd"><p>While</p></td><td class="confluenceTd"><p>While (condition)<br class="atl-forced-newline" />BEING<br class="atl-forced-newline" />END<br class="atl-forced-newline" />BREAK =&gt;while statement escape</p></td><td class="confluenceTd"><p>While condition loop<br class="atl-forced-newline" />End loop<br class="atl-forced-newline" />Exit when condition =&gt; Repeat loop escape when condition is satisfied</p></td></tr></tbody></table></div><h3 id="id-2.SQLConversion-5.Identityattribute">5. Identity attribute</h3><hr /><p>Identity attribute does not exist in ALTIBASE. Therefore, if necessary, create and use a SEQUENCE</p><h3 id="id-2.SQLConversion-6.ProcedureConversion">6. Procedure Conversion</h3><hr /><p>ALTIBASE PROCEDURE creation and execution statements are different from SQL Server.<br />Check how to change PROCEDURE with an example.</p><h4 id="id-2.SQLConversion-1.ParameterDeclaration">1. Parameter Declaration</h4><p>Remove the'@' sign from the SQL Server parameter declaration.</p><p>In, out, and in out are specified according to the nature of the parameter.</p><p>In the case of a function, one value is returned after execution. The data type following RETURN must be specified.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
CREATE Procedure <a class="external-link" href="https://aid.altibase.com/pages/createpage.action?spaceKey=DOCKI&amp;title=dbo" rel="nofollow">dbo</a>.<a class="external-link" href="https://aid.altibase.com/pages/createpage.action?spaceKey=DOCKI&amp;title=sp1" rel="nofollow">sp1</a><br />@nTop INT – Ignore<br />, @nGroupCode INT = -2<br />, @nObjectCode INT = -2<br />, @nRCLS INT=1 – 1:Set , 0:Unset<br />, @nLCRS INT=1 – 1:Set , 0:Unset<br />, @nLCLS INT=1 – 1:Set , 0:Unset<br />, @sStartDate VARCHAR(19) = '' – Ignore<br />, @sEndDate VARCHAR(19) = '' – Ignore<br />, @nSort INT = 0 – 0: number of detections, 1: number of attempts 2: DataSize<br />, @sSignatureName VARCHAR(100) = ''<br />As<br />…
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
create or replace procedure sp1<br />(<br />i_nTop IN INT – Ignore<br />, i_nGroupCode IN INT := -2<br />, i_nObjectCode IN INT := -2<br />, i_nRCLS IN INT:=1 – 1:Set , 0:Unset<br />, i_nLCRS IN INT:=1 – 1:Set , 0:Unset<br />, i_nLCLS IN INT:=1 – 1:Set , 0:Unset<br />, i_sStartDate IN VARCHAR(19) := '' – Ignore<br />, i_sEndDate IN VARCHAR(19) := '' – Ignore<br />, i_nSort IN INT := 0 – 0: number of detections, 1: number of attempts 2: DataSize<br />, i_sSignatureName IN VARCHAR(100) := ''<br />)<br />as …
</div></div><h4 id="id-2.SQLConversion-2.VariableDeclaration">2. Variable Declaration</h4><p>Altibase's variable declaration is defined between AS and BEGIN.<br />Remove the'@' sign from the variable declaration in SQL Server.<br />When declaring a variable, the separator ‘,’ is replaced with ‘;’.<br />Even in the last variable declaration, it is always declared the last with';'.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
create or replace procedure sp1<br />(<br />……<br />)<br />as<br />DECLARE @sTotalQry VARCHAR(3000)<br />, @sQry VARCHAR(3000)<br />, @sFilterQry VARCHAR(1000)<br />, @dStartDate DATETIME<br />, @dEndDate DATETIME<br />, @sSort VARCHAR(20)<br />, @sSortSub VARCHAR(90)<br />, @sTop VARCHAR(10)<br />, @sTable VARCHAR(50)<br />, @nSec INT<br />, @sBaseDate VARCHAR(23)
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>create or replace procedure sp1<br />(<br />……<br />)<br />as<br />i_sTotalQry VARCHAR(3000);<br />i_sQry VARCHAR(3000);<br />i_sFilterQry VARCHAR(1000);<br />i_dStartDate DATE;<br />i_dEndDate DATE;<br />i_sSort VARCHAR(20);<br />i_sSortSub VARCHAR(90);<br />i_sTop VARCHAR(10);<br />i_sTable VARCHAR(50);<br />i_nSec INT;<br />i_sBaseDate VARCHAR(23);</p>
</div></div><h4 id="id-2.SQLConversion-3.ASSIGNMENT">3. ASSIGNMENT</h4><p>Use SET when assigning values to variables in SQL Server. Here, the SET and ‘@’ characters are removed.<br />Then, ‘=’ is replaced with ‘:= ’.<br />The separator ‘,’ is replaced with ‘;’, and the last is always declared with ‘;’.<br />The variable can be assigned by specifying SET as above.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
SET @sTop = '1000'<br />SET @sBaseDate = CONVERT(VARCHAR, DATEADD(dd, -1, GETDATE()), 121)
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
i_sTop := '1000' ;<br />i_sBaseDate := to_char(DATEADD (SYSDATE, -1, 'DAY'), 'YYYY-MM-DD HH:MI:SS') ;<br />OR<br />Set i_sTop = '1000' ;<br />Set i_sBaseDate = to_char(DATEADD (SYSDATE, -1, 'DAY'), 'YYYY-MM-DD HH:MI:SS') ;
</div></div><h4 id="id-2.SQLConversion-4.Control_flow–IFStatement">4. Control_flow – IF Statement</h4><p>At the end of ALTIBASE sentences, always indicate the end with';'.<br />At the beginning of the IF statement, the first is marked as IF (condition) THEN.<br />At the end of the IF statement, END IF indicates the end of the IF statement.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
IF (@nRCLS = 1) AND (@nLCRS = 1) AND (@nLCLS = 1) SET @sFilterQry = ''<br />ELSE IF (@nRCLS = 0) AND (@nLCRS = 0) AND (@nLCLS = 0) SET @sFilterQry = ''
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
IF (i_nRCLS = 1) AND (i_nLCRS = 1) AND (i_nLCLS = 1) THEN<br />i_sFilterQry := '' ;<br />ELSIF (i_nRCLS = 0) AND (i_nLCRS = 0) AND (i_nLCLS = 0) THEN<br />i_sFilterQry := '' ;<br />END IF;
</div></div><h4 id="id-2.SQLConversion-5.SELECTStatement">5. SELECT Statement</h4><p>At the end of ALTIBASE sentences, always indicate the end with';'.<br />To send the resultset of select to the client in ALTIBASE, REF CURSOR must be written in the DB object first. And ref cursor should be written as an argument to the argument of sp. In addition, when executing the query, execute it with the command called Open.<br />Remove the'@' character from SQL Server.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
……<br />SET @sQry = 'select * from test_tbl'<br />EXEC(@sQry)<br />……
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
CREATE TYPESET MY_TYPE<br />AS<br />TYPE MY_CUR IS REF CURSOR;<br />END;<br />/<br />create or replace procedure spTMSGetEventSignatureRankVariation<br />(<br />……<br />, P1 OUT MY_TYPE.MY_CUR<br />)<br />As<br />i_sQry := 'select * from test_tbl' ;<br />OPEN P1 FOR i_sQry;<br />END;
</div></div><p> </p><div class="wiki-content"><h4 id="id-2.SQLConversion-6.ExceptionHandler">6. Exception Handler</h4><p>At the end of ALTIBASE sentences, always indicate the end with';'.</p><p>ALTIBASE's Exception Handler is to handle when a corresponding exception occurs.</p><p>Exception handling is always BEGIN… . END; It must be processed within the syntax.</p><p>Describes the name of a system-defined EXCEPTION or user-defined EXCEPTION, processes the statement when it encounters a corresponding exception, and finally handles the OTHERS routine if the current exception cannot be handled.</p><p>The statement for checking whether the number of applied records is 0 can be checked with the SQL%ROWCOUNT constant.<br />System-defined exceptions are attached at the end of the file.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
IF @@ERROR &lt;&gt; 0 BEGIN<br />IF @@ROWCOUNT = 0 BEGIN<br />ROLLBACK<br />END<br />END
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>BEGIN<br />……<br />EXCEPTION WHEN NO_DATA_FOUND THEN<br />rollback;<br />END;</p><p>OR<br />IF SQL%ROWCOUNT = 0 then<br />ROLLBACK<br />END if;</p>
</div></div><p> </p><h4 id="id-2.SQLConversion-7.SPCall">7. SP Call</h4><p>At the end of ALTIBASE sentences, always indicate the end with';'.<br />The SQL Server's SP call is called with exec sp_name and sp arguments are specified without parentheses, but SP_name is executed in ALTIBASE and sp arguments are specified in parentheses.<br />Remove the'@' character from SQL Server.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
IF @ID IS NOT NULL BEGIN<br />EXEC SP_Product_Reservation Inquiry_Check Member Category,Date2
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
IF i_ID IS NOT NULL THEN<br />SP_Product_Reservation Inquiry_Member Check (i_Social Security Number,i_Division,i_Date1,i_Date2);
</div></div><h4 id="id-2.SQLConversion-8.Functions"><span style="color: rgb(0,0,0);">8. Functions</span></h4><p>At the end of ALTIBASE sentences, always indicate the end with';'.<br />The usage may be different for each function, and the function name may be different.<br />Remove the'@' character from Mssql.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>1. LEFT, RIGHT Functions</p><ul class="alternate"><li>LEFT(@Social Security Number,6)</li><li>RIGHT(@Social Security Number,7)<br />2. ISNULL(V1, 0)<br />3. CASE Alliance WHEN '0' THEN B. Foreign Visitor + B. Package ELSE ISNULL (D. Alliance Visitor, 0) END<br />4. Convert<br />CONVERT(VARCHAR(10),,120) &lt;= B. Departure date TO_CHAR(CASE2(i_departure date1=NULL,SYSDATE),'YYYY-MM-DD');<br />5. LEN<br />6. RTRIM(LTRIM())<br />7. DATEADD(mi, -20, GETDATE())<br />8. CEILING<br />9. Other operators % (a % b )<br />10. charIndex(‘aaa’, ‘aaabbbcccddd’)<br />11. String connection + : (‘alti’ + ‘base’)</li></ul>
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>1. Replace with SubStr</p><ul class="alternate"><li>SUBSTR(Social Security Number,1,6)</li><li>SUBSTR(Socail Security Number,8,7)<br />2. NVL(V1, 0)<br />3. CASE2(Alliance = '0', B. Foreign guest || B. Package, D. Combined guest=NULL,0,)<br />4. Convert</li><li>CONVERT(VARCHAR(23), dStartDate, 121) =&gt; TO_CHAR(dStartDate, 'YYYY-MM-DD HH:MI:SS.FF3');</li><li>CONVERT(DATETIME, sEndDate) =&gt; TO_DATE(sEndDate, 'YYYY-MM-DD HH:MI:SS');<br />5. LENGTH<br />6. TRIM()<br />7. DATEADD(sysdate, -20, 'MINITUE');<br />8. CEIL<br />9. MOD(a, b)<br />10. INSTR(‘aaabbbcccddd’, ‘aaa’)<br />11. || use (‘alti’ || ’base’)</li></ul>
</div></div><h4 id="id-2.SQLConversion-9.Etc">9. Etc</h4><p>At the end of ALTIBASE sentences, always indicate the end with';'.<br />Remove the'@' character from SQL Server.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
1. UPDATE STATISTICS index_name<br />2. with (nolock)<br />3. Use of keywords such as order and level
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
1. Unnecessary<br />2. Delete<br />3. Prohibit the use of keywords such as order and level (Altibase reserved words)
</div></div><h4 id="id-2.SQLConversion-10.DBLink">10. DB Link</h4><p>When using the DB Link in ALTIBASE, REMOTE_TABLE(dblink name, Query) for SELECT;</p><p>Use REMOTE_EXECUTE_IMMEDIATE(dblink name, Query) for DML.</p><h4 id="id-2.SQLConversion-11.JOINUPDATE">11. JOIN UPDATE</h4><p>There are two methods to execute Join Update in ALTIBASE.</p><p>1. Use JOIN UPDATE</p><ul class="alternate"><li>There must be a primary key or unique key in each table.</li></ul><p>2. Use the update of Merge Join</p><ul class="alternate"><li>Merge into A using ( SELECT … )<br />WHEN matched then<br />Update …</li></ul><h3 id="id-2.SQLConversion-7.UsingCursor">7. Using Cursor</h3><hr />Check how to convert SQL Server cursor to ALTIBASE with the example.<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>SQL Server</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
declare security_cursor cursor for<br />select fldID from tblDept where fldParentID=@fldID<br />open security_cursor<br />fetch next from security_cursor into @fldID<br />while @@fetch_status = 0<br />begin<br />exec sr_GetSubDeptID_Str @fldID, @DeptID OUTPUT<br />declare @sql as varchar(8000)<br />begin<br />exec(@sql)<br />end<br />fetch next from security_cursor into @fldID<br />end<br />close security_cursor<br />deallocate security_cursor
</div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>ALTIBASE</p></th></tr></tbody></table></div><div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>This is a procedure to find the total number of employees and salaries by the department.</p><p>CREATE OR REPLACE PROCEDURE ForCursor_Test<br />AS<br />BEGIN<br />DECLARE CURSOR dept_sum IS<br />SELECT b.dname, COUNT(a.empno) cnt, SUM(a.sal) salary<br />FROM emp a, dept b<br />WHERE a.deptno = b.deptno<br />GROUP BY b.dname;<br />– Execute Cursor in the FOR statement.</p><p>BEGIN<br />FOR emp_list IN dept_sum LOOP</p><p>println('Department name: 'emp_list.dname);<br />println ('Number of employees: '|| emp_list.cnt);<br />println('Sum of salary: 'emp_list.salary);</p><p>END LOOP;<br />END;<br />END;<br />/</p>
</div></div><p> </p><h2 id="id-2.SQLConversion-EXCEPTIONCODE"><strong>EXCEPTION CODE</strong></h2><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>Exception Name</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>Error Code</strong><br class="atl-forced-newline" /><strong>(integer)</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>Error Code</strong><br class="atl-forced-newline" /><strong>(hexadecimal)</strong></p></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><p><strong>Error Section</strong></p></div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>&quot;CURSOR_ALREADY_OPEN&quot;</p></td><td class="confluenceTd"><p>201062</p></td><td class="confluenceTd"><p>31166</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_CURSOR_ALREADY_OPEN</p></td></tr><tr><td class="confluenceTd"><p>&quot;DUP_VAL_ON_INDEX&quot;</p></td><td class="confluenceTd"><p>201063</p></td><td class="confluenceTd"><p>31167</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_DUP_VAL_ON_INDEX</p></td></tr><tr><td class="confluenceTd"><p>&quot;INVALID_CURSOR&quot;</p></td><td class="confluenceTd"><p>201064</p></td><td class="confluenceTd"><p>31168</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_INVALID_CURSOR</p></td></tr><tr><td class="confluenceTd"><p>&quot;INVALID_NUMBER&quot;</p></td><td class="confluenceTd"><p>201065</p></td><td class="confluenceTd"><p>31169</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_INVALID_NUMBER</p></td></tr><tr><td class="confluenceTd"><p>&quot;NO_DATA_FOUND&quot;</p></td><td class="confluenceTd"><p>201066</p></td><td class="confluenceTd"><p>3116A</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_NO_DATA_FOUND</p></td></tr><tr><td class="confluenceTd"><p>&quot;PROGRAM_ERROR&quot;</p></td><td class="confluenceTd"><p>201067</p></td><td class="confluenceTd"><p>3116B</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_PROGRAM_ERROR</p></td></tr><tr><td class="confluenceTd"><p>&quot;STORAGE_ERROR&quot;</p></td><td class="confluenceTd"><p>201068</p></td><td class="confluenceTd"><p>3116C</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_STORAGE_ERROR</p></td></tr><tr><td class="confluenceTd"><p>&quot;TIMEOUT_ON_RESOURCE&quot;</p></td><td class="confluenceTd"><p>201069</p></td><td class="confluenceTd"><p>3116D</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_TIMEOUT_ON_RESOURCE</p></td></tr><tr><td class="confluenceTd"><p>&quot;TOO_MANY_ROWS&quot;</p></td><td class="confluenceTd"><p>201070</p></td><td class="confluenceTd"><p>3116E</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_TOO_MANY_ROWS</p></td></tr><tr><td class="confluenceTd"><p>&quot;VALUE_ERROR&quot;</p></td><td class="confluenceTd"><p>201071</p></td><td class="confluenceTd"><p>3116F</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_VALUE_ERROR</p></td></tr><tr><td class="confluenceTd"><p>&quot;ZERO_DIVIDE&quot;</p></td><td class="confluenceTd"><p>201072</p></td><td class="confluenceTd"><p>31170</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_ZERO_DIVIDE</p></td></tr><tr><td class="confluenceTd"><p>&quot;INVALID_PATH&quot;</p></td><td class="confluenceTd"><p>201237</p></td><td class="confluenceTd"><p>31215</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_INVALID_PATH</p></td></tr><tr><td class="confluenceTd"><p>&quot;INVALID_MODE&quot;</p></td><td class="confluenceTd"><p>201235</p></td><td class="confluenceTd"><p>31213</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_INVALID_FILEOPEN_MODE</p></td></tr><tr><td class="confluenceTd"><p>&quot;INVALID_FILEHANDLE&quot;</p></td><td class="confluenceTd"><p>201238</p></td><td class="confluenceTd"><p>31216</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_INVALID_FILEHANDLE</p></td></tr><tr><td class="confluenceTd"><p>&quot;INVALID_OPERATION&quot;</p></td><td class="confluenceTd"><p>201239</p></td><td class="confluenceTd"><p>31217</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_INVALID_OPERATION</p></td></tr><tr><td class="confluenceTd"><p>&quot;READ_ERROR&quot;</p></td><td class="confluenceTd"><p>201242</p></td><td class="confluenceTd"><p>3121A</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_READ_ERROR</p></td></tr><tr><td class="confluenceTd"><p>&quot;WRITE_ERROR&quot;</p></td><td class="confluenceTd"><p>201243</p></td><td class="confluenceTd"><p>3121B</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_WRITE_ERROR</p></td></tr><tr><td class="confluenceTd"><p>&quot;ACCESS_DENIED&quot;</p></td><td class="confluenceTd"><p>201236</p></td><td class="confluenceTd"><p>31214</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_DIRECTORY_ACCESS_DENIED</p></td></tr><tr><td class="confluenceTd"><p>&quot;DELETE_FAILED&quot;</p></td><td class="confluenceTd"><p>201240</p></td><td class="confluenceTd"><p>31218</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_DELETE_FAILED</p></td></tr><tr><td class="confluenceTd"><p>&quot;RENAME_FAILED&quot;</p></td><td class="confluenceTd"><p>201241</p></td><td class="confluenceTd"><p>31219</p></td><td class="confluenceTd"><p>qpERR_ABORT_QSX_FILE_RENAME_FAILED</p></td></tr></tbody></table></div></div></div></div>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 23, 2021 09:49</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
