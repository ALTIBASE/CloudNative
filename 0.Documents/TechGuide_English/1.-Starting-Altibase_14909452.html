<!DOCTYPE html>
<html>
    <head>
        <title>Technical Documents(English) : 1. Starting Altibase</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Technical Documents(English)</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home_557064.html">Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="14909450.html">Understanding the Altibase Start/Shut down Process</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Technical Documents(English) : 1. Starting Altibase
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
    
            Created by <span class='author'> richard.nahm	</span>, last modified on Feb 22, 2021
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <hr /><p>Altibase classifies the starting process into four stages.</p><p>This chapter describes the state of each step in which Altibase is starting up and the operations performed internally when transitioning to each step.</p><p>Additionally, by describing the tasks that the user can perform in each step, Altibase can be used efficiently.</p><h1 id="id-1.StartingAltibase-Overview">Overview</h1><hr /><p>When the DB startup process comes one step, the operations that can be done before the server is started and the operations that can be done after the server is started are strictly separated, so that the DB is started with a single command execution, so the DBA cannot perform a task distinct from the client.</p><p>This leads to restrictions on meta-migration and recovery functions.</p><p>In order to solve this problem, Altibase provides the DB starting process by classifying into 4 stages: PROCESS, CONTROL, META, and SERVICE.</p><p>At each stage, DBA can create DB, upgrade meta, and restore by selection.</p><p>When starting Altibase, to transition to each step, a command called &quot;STARTUP&quot; is used, which can be used after accessing iSQL with SYSDBA privileges.</p><p>When changing the state in each step, the transition to the next step is possible, but returning to the previous step is not supported.</p><p><img class="confluence-embedded-image" src="attachments/14909452/15073281.png" data-image-src="attachments/14909452/15073281.png"></p><p>In the figure above, the arrows indicate the process of state transition, and the colors indicate the state of each step.</p><p>The user can perform the functions provided in each step.</p><p>In the below, the operations performed internally by Altibase in each step and the operation that can be performed by the user are described.</p><h1 id="id-1.StartingAltibase-PROCESSStage"><span style="color: rgb(0,0,0);">PROCESS Stage</span></h1><hr /><ul><li><span style="color: rgb(0,0,0);">PROCESS stage transition command</span><br /><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);"> </span></span><hr /><span style="color: rgb(0,0,0);">This is the first step when starting Altibase, and the stage can be transitioned with the &quot;STARTUP PROCESS&quot; command.</span><br /><span style="color: rgb(0,0,0);"><img class="confluence-embedded-image" src="attachments/14909452/15073282.png" data-image-src="attachments/14909452/15073282.png"><br /></span><span style="color: rgb(0,0,0);">Accessing to the DB is not available at this state. The PROCESS stage is the stage in which each module (Storage Manager, Query Process, Communication Manager, etc.) is initialized, and the Altibase process is started for communication between the server and iSQL.</span></li></ul><div><ul><li>Initial → Internal operation of the PROCESS stage<hr />Altibase records the starting process in $ALTIBASE_HOME/trc/altibase_boot.log file, so the user can check what operation the DB internally performs in each step.<br />The following is the contents of altibase_boot.log recorded when starting in the PROCESS stage, and check what operations are performed with it.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073283.png" data-image-src="attachments/14909452/15073283.png"></li><li>Initialize each module to create or start Altibase<ul><li>Check and loading property file <strong>(01)</strong><ul><li>Checking and loading the $ALTIBASE_HOME/conf/altibase.properities file</li></ul></li><li>Check License Validity <strong>(02)</strong></li><li>Initialize Process Signal System <strong>(04)</strong></li><li>Check ide Layer Initialization Result<strong> (05)</strong></li><li>Initialize Error Message Binary File <strong>(06)</strong></li><li>Initialize All Module Message Logging System <strong>(07)</strong></li><li>Logging Host System Up-Time<strong> (09)</strong></li><li>Do Daemonizing<strong> (10)</strong></li><li>Process Lock File Initialization<strong> (12)</strong><ul><li>Acquire lock in $ALTIBASE_HOME/conf/altibase.properties file</li><li>Avoid replication startup of Altibase process</li></ul></li><li>Lock Manager <strong>(14)</strong><ul><li>Initialize the lock item used for concurrency control.</li></ul></li><li>Initialize server's main module<ul><li style="text-align: left;">Communication Manager <strong>(25)</strong></li><li style="text-align: left;">Storage Manager <strong>(26)</strong></li><li style="text-align: left;">Query Processor <strong>(27)</strong></li><li style="text-align: left;">Database Link Module <strong>(28)</strong></li><li>Start Altibase process and communicate with iSQL</li></ul></li><li>DB space is not accessible</li><li>Only access to the fixed table</li><li>Meta-related initialization or operation is impossible (DB is not accessible)</li><li>CREATE/DROP DATABASE can be executed</li></ul></li></ul><p> </p><ul><li>Operations can be done in the PROCESS stage<hr />The tasks that users can perform in the PROCESS stage are as follows.<ul><li>Creating a database using the CREATE DATABASE statement<br /><img class="confluence-embedded-image" src="attachments/14909452/15073284.png" data-image-src="attachments/14909452/15073284.png"></li><li>Change the property value<ul><li>Change the property value that can be changed with the ALTER command in ISQL</li></ul></li><li><p>Performance view that users can view</p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th colspan="1" style="text-align: center;" class="confluenceTh"><div class="tablesorter-header-inner">View</div></th><th colspan="1" style="text-align: center;" class="confluenceTh"><div class="tablesorter-header-inner">Description</div></th></tr></thead><tbody><tr><td colspan="1" class="confluenceTd">V$ACCESS_LIST</td><td colspan="1" class="confluenceTd">Access permission and restriction information of specific IP packets accessing Altibase</td></tr><tr><td class="confluenceTd"><p>V$ALLCOLUMN</p></td><td class="confluenceTd">Column information for configuring performance views<p> </p></td></tr><tr><td class="confluenceTd"><p>V$DBA_2PC_PENDING</p></td><td class="confluenceTd">List of transaction branches in the in-doubt state in distributed transactions<p> </p></td></tr><tr><td colspan="1" class="confluenceTd">V$DIRECT_PATH_INSERT</td><td colspan="1" class="confluenceTd">Statistical information related to direct-path upload</td></tr><tr><td class="confluenceTd">V$INSTANCE</td><td class="confluenceTd">Current Altibase multi-level operation information<p> </p></td></tr><tr><td colspan="1" class="confluenceTd">V$NLS_TERRITORY</td><td colspan="1" class="confluenceTd">Performance view that stores the names of regions that can be set in the database or current session</td></tr><tr><td class="confluenceTd"><p>V$PROPERTY</p></td><td class="confluenceTd">Property information set in the Altibase</td></tr><tr><td class="confluenceTd">V$TABLE</td><td class="confluenceTd"><p>Record and column information of all performance views</p></td></tr><tr><td colspan="1" class="confluenceTd">V$TIME_ZONE_NAMES                                        </td><td colspan="1" class="confluenceTd">List of zone names and abbreviations and UTC offset values that can be set in the TIME_ZONE property</td></tr><tr><td class="confluenceTd"><p>V$TRACELOG</p></td><td class="confluenceTd">Trace logging information</td></tr><tr><td colspan="1" class="confluenceTd">V$TRANSACTION</td><td colspan="1" class="confluenceTd">Transaction object information</td></tr><tr><td colspan="1" class="confluenceTd">V$TRANSACTION_MGR</td><td colspan="1" class="confluenceTd">Altibase transaction manager information</td></tr><tr><td colspan="1" class="confluenceTd">V$TXSEGS</td><td colspan="1" class="confluenceTd">Bound transaction segments information</td></tr><tr><td colspan="1" class="confluenceTd">V$VERSION</td><td colspan="1" class="confluenceTd">Altibase version information</td></tr></tbody></table></div></li><li>Transition to higher levels such as the CONTROL stage</li></ul></li></ul><h1 id="id-1.StartingAltibase-CONTROLStage"><span style="color: rgb(0,0,0);">CONTROL Stage</span></h1><hr /><ul><li><p><span style="color: rgb(0,0,0);"> </span>CONTROL stage transition command</p><hr /><p>The CONTROL stage can transition state with the &quot;STARTUP CONTROL&quot; command after completing the tasks in the PROCESS stage.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073285.png" data-image-src="attachments/14909452/15073285.png"></p></li><li>PROCESS step → Internal operation of CONTROL stage<br /><hr />The CONTROL stage is a stage in which each manager is initialized to the level where DB recovery is possible and the main managers (Buffer, Recovery, Disk, etc.) configuring the Storage Manager module are prepared.<br />The following is the contents of altibase_boot.log recorded when starting in the CONTROL stage, and check what operations are performed with it.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073286.png" data-image-src="attachments/14909452/15073286.png"></li><li>Initialize each module to the level where DB recovery is possible<ul><li style="text-align: left;">Communication Manager <strong>(01)</strong></li><li style="text-align: left;">Storage Manager <strong>(02)</strong></li><li style="text-align: left;">Query Processor <strong>(17)</strong></li><li style="text-align: left;">Prohibit change operation of DB using the DDL and DML</li></ul></li><li style="text-align: left;">Prepare the Storage Manager module to a level where recovery is possible <strong>(03)~(16)</strong><ul><li style="text-align: left;">Prepare Buffer Manager, Disk Manager, Recovery Manager, etc.</li></ul></li></ul><p style="text-align: left;"> </p><ul><li style="text-align: left;">Operations can be done in the CONTROL stage<br /><hr />The operations that the user can perform in the CONTROL stage are as follows.<ul><li style="text-align: left;">Perform Altibase recovery using the following DB recovery statement<br /><img class="confluence-embedded-image" src="attachments/14909452/15073287.png" data-image-src="attachments/14909452/15073287.png"></li><li style="text-align: left;">Initialize online log file<br />Since DB Restart Recovery is performed in the META stage, if incomplete recovery is performed in the CONTROL stage, online log files that are not reflected in the recovery may cause problems in the process of starting the DB.<br />Therefore, in the case of recovery, the online log file must be reset by using the following command before the transition to the META stage.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073288.png" data-image-src="attachments/14909452/15073288.png"></li><li style="text-align: left;">Change database mode<br /><img class="confluence-embedded-image" src="attachments/14909452/15073289.png" data-image-src="attachments/14909452/15073289.png"></li><li style="text-align: left;"><p>Retrieve performance view<br />The performance view can be retrieved in the PROCESS stage and the following performance view can be retrieved additionally. (Normal tables cannot be retrieved.)</p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th colspan="1" style="text-align: center;" class="confluenceTh"><div class="tablesorter-header-inner">View</div></th><th colspan="1" style="text-align: center;" class="confluenceTh"><div class="tablesorter-header-inner">Description</div></th></tr></thead><tbody><tr><td colspan="1" class="confluenceTd">V$BACKUP_INFO</td><td colspan="1" class="confluenceTd">Information on all incremental backups performed up to date</td></tr><tr><td class="confluenceTd"><p>V$DATAFILES</p></td><td class="confluenceTd">Information on data files used by the tablespace<p> </p></td></tr><tr><td class="confluenceTd"><p>V$FILESTAT</p></td><td class="confluenceTd">I/O statistics information for each data file on the disk<p> </p></td></tr><tr><td class="confluenceTd">V$LFG</td><td class="confluenceTd">Statistics value related to group commit<p> </p></td></tr><tr><td class="confluenceTd"><p>V$LOCK_WAIT</p></td><td class="confluenceTd">Information on transaction lock wait status<p> </p></td></tr><tr><td colspan="1" class="confluenceTd">V$LOG</td><td colspan="1" class="confluenceTd">Log anchor file information</td></tr><tr><td colspan="1" class="confluenceTd">V$MEM_TABLESPACE_CHECKPOINT_PATHS</td><td colspan="1" class="confluenceTd"><p>When a checkpoint occurs for a specific tablespace (memory), the changed page (dirty page) is reflected.<br />The location of the database image file (directory path)</p></td></tr><tr><td class="confluenceTd">V$MEM_TABLESPACE_STATUS_DESC</td><td class="confluenceTd">Information on the contents of the status value of the memory tablespace<p> </p></td></tr><tr><td colspan="1" class="confluenceTd">V$OBSOLETE_BACKUP_INFO</td><td colspan="1" class="confluenceTd"><p>Information on backups that are no longer need to maintain<br />(As part of V$BACKUP_INFO, refer to V$BACKUP_INFO information for details)                                                                </p></td></tr><tr><td class="confluenceTd"><p>V$TABLESPACES</p></td><td class="confluenceTd">Tablespace information</td></tr><tr><td colspan="1" class="confluenceTd">V$TSSEGS</td><td colspan="1" class="confluenceTd">All TSS segments information</td></tr></tbody></table></div></li></ul></li></ul><ul><li style="list-style-type: none;background-image: none;"><ul><li style="text-align: left;">Transition to a higher stage such as META stage.</li></ul></li></ul><h1 style="text-align: left;" id="id-1.StartingAltibase-METAstage">META stage</h1><hr /><ul><li>META stage transition command<br /><hr />The META stage can transition stage with the &quot;STARTUP META&quot; command after completing the tasks in the CONTROL stage.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073290.png" data-image-src="attachments/14909452/15073290.png"></li><li>CONTROL stage → Internal operation of META stage<br /><hr />The META stage is the completion step for the recovery process performed in the CONTROL stage, and checks the data files in the memory and disk to start the DB, and then performs Restart Recovery.<br />The following is the contents of altibase_boot.log recorded when starting in the META stage, and checks what operations are performed with it.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073291.png" data-image-src="attachments/14909452/15073291.png"><br /><ul><li>Initialize of each module to the level that DB can be started by checking errors and restart<ul><li>Initialization of each module<ul><li style="text-align: left;">Communication Manager <strong>(01)</strong></li><li style="text-align: left;">Storage Manager <strong>(02)</strong></li><li style="text-align: left;">Query Processor <strong>(16)</strong></li><li style="text-align: left;">Database Link Module <strong>(18)</strong></li></ul></li><li style="text-align: left;">Check media errors for data files <strong>(03) ~ (04)</strong><ul><li style="text-align: left;">Check/Identify DB</li><li style="text-align: left;">Check memory/disk tablespace data files and online log files to check if normal operation is possible.</li></ul></li><li style="text-align: left;">Restart recovery process for DBMS <strong>(07)</strong><ul><li style="text-align: left;">If the DB is started after a normal shutdown, then restart recovery process is skipped. However, if the DB is started after an abnormal shutdown, Restart Recovery is performed.<strong><br /></strong></li></ul></li><li style="text-align: left;">Transaction Segment Entries Rebuild <strong>(09)</strong><ul><li style="text-align: left;"><p>Rebuild Transaction Segment because TSS (Transaction Status Slot) is required when a transaction starts.</p></li><li style="text-align: left;"><p>Since the Transaction Segment is included in the Undo Tablespace, reset the Undo Tablespace.</p></li></ul></li><li>Start the checkpoint thread</li><li>Minimum SCN Rebuild <strong>(10)</strong><ul><li>Create Minimum SCN to delete old version data due to MVCC<strong><br /></strong></li></ul></li><li>Garbage Collector<ul><li>Delete the old key of Index</li></ul></li><li>Delete Manager<ul><li>Delete the old record of the table</li></ul></li><li>Memory Index Rebuilding<ul><li>Since memory has a volatile feature, the index rebuilds when starting a new database after the DB is shutdown.</li></ul></li><li>Memory Table Refining</li><li>Memory DB's free slot and free page information is run-time information that is not recorded on the disk, so it must be rebuilt during operation, and these operations are performed when refining the memory table.</li><li>DB change operation using the DDL and DML is prohibited.</li></ul></li></ul></li><li>Operations can be done in the META stage<br /><hr />The operations that users can p[perform in the META stage are as follows.<ul><li>All performance views can be retrieved.</li><li>Transition to a higher stage such as the SERVICE stage is possible.</li></ul></li></ul><h1 id="id-1.StartingAltibase-SERVICEStage">SERVICE Stage</h1><hr /><ul><li>SERVICE stage transition command<br /><hr />The SERVICE stage can transition stage with the &quot;STARTUP SERVICE or STARTUP&quot; command after completing the tasks in the META stage.<br /><img class="confluence-embedded-image" src="attachments/14909452/15073292.png" data-image-src="attachments/14909452/15073292.png"></li><li>META stage → Internal operation of SERVICE stage<br /><hr /><p>The SERVICE stage is the final stage in which the user can use the DB.</p><p>When it is started in the SERVICE stage, it becomes a state in which general database users can access it.</p><p>The following is the contents of altibase_boot.log recorded when it is started in the SERVICE stage, and checks what operations are performed with it.</p><p><img class="confluence-embedded-image" src="attachments/14909452/15073293.png" data-image-src="attachments/14909452/15073293.png"></p></li><li>Initialize each module to provide normal DB service to users.<ul><li>Initialize the Communication Manager <strong>(01)</strong><ul><li>Start the Listener</li></ul></li><li>Initialize each module for DB service <strong>(02) ~ (03), (05) ~ (08)</strong><ul><li>Query Processor, Database Link Module, Security Module, etc.</li></ul></li><li>Check the Meta DB <strong>(04)</strong></li><li>Table, index, etc.</li><li>Initialize replication module <strong>(09)</strong><ul><li>Read the replication information</li><li>Start the replication manager</li><li>Start the replication Heart Beat Manager</li></ul></li><li>Send each stage message to iSQL and send a success message</li></ul></li></ul><p> </p><ul><li>Operations can be done in the SERVICE stage<br /><hr />The operations that users can perform in the SERVICE stage are as follows.<br /><ul><li>iSQL connection</li><li>Normal DB operation is possible.</li></ul></li></ul><p> </p></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073281.png">image2019-5-14 12_56_31.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073282.png">STARTUP PROCESS.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073283.png">STARTUP PROCESS LOG.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073284.png">CREATE DATABASE 구문.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073285.png">STARTUP CONTROL.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073286.png">STARTUP CONTROL LOG.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073287.png">DB RECOVERY SQL.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073288.png">META RESET LOG SQL.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073289.png">CHANGE ARCHIVE LOG MODE.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073290.png">STARTUP META.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073291.png">STARTUP META LOG.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073292.png">STARTUP SERVICE.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/14909452/15073293.png">STARTUP SERVICE LOG.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 23, 2021 09:49</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
