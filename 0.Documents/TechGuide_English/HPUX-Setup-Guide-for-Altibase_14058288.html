<!DOCTYPE html>
<html>
    <head>
        <title>Technical Documents(English) : HPUX Setup Guide for Altibase</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Technical Documents(English)</a></span>
                            </li>
                                                    <li>
                                <span><a href="Home_557064.html">Home</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Technical Documents(English) : HPUX Setup Guide for Altibase
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
    
            Created by <span class='author'> richard.nahm	</span>, last modified by <span class='editor'> david.cho</span> on Dec 22, 2020
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-Overview"><span class="md-plain">Overview</span></h2><p class="md-end-block md-p"><span class="md-plain">This document provides guides for setting appropriate values of kernel parameters and various user environment settings for installing and operating Altibase in Hewlett Packard Unix (UPUX) Operating System.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">In this document, the guide is presented only for the operating system related items to be set before Altibase is installed, and refer to the separate document &quot;Altibase Configuration File Guide&quot; for setting Altibase properties for setting Altibase itself.</span></p><h2 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-KernelParameters"><span class="md-plain">Kernel Parameters</span></h2><p class="md-end-block md-p"><span class="md-plain">When operating Altibase on the HPUX operating system, it describes the types of kernel parameters that need to be changed and why they need to be changed and introduces how to change the kernel parameters.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">For details related to each kernel parameter, please refer to the guide provided by HP.</span></p><h3 class="md-end-block md-heading md-focus" id="HPUXSetupGuideforAltibase-SharedMemory"><span class="md-plain">Shared Memory</span></h3><p class="md-end-block md-p"><span class="md-plain">When developing an application program, there is a need for two or more processes to exchange information. The operating system provides a resource called IPC (Inter Process Communication). Among various IPC resources, the memory area used by two or more processes to exchange information is called shared memory.</span></p><p class="md-end-block md-p"><span class="md-plain">When the Altibase server and client use the IPC connection method, shared memory is used as a communication buffer, so the kernel parameter values such as the maximum size for the part using memory or the number of segments must be set correctly.</span></p><p class="md-end-block md-p"><span class="md-plain md-expand">The recommended kernel parameters and Altibase values related to shared memory in a typical Unix system are as follows.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span md-focus"><span class="md-plain md-expand">Kernel Parameter</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">shmmax</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of one shared memory segment</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">2GB+1</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">shmmni</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of shared memory segments in the system</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">500 or more</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">shmseg</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of shared memory segments attached to one process</span></span></td><td class="confluenceTd"><span class="td-span md-focus"><span class="md-plain md-expand">200 or more</span></span></td></tr></tbody></table></div><ul class="ul-list"><li class="md-list-item md-focus-container"><p class="md-end-block md-p md-focus"><span class="md-plain md-expand">IPC_CHANNEL_COUNT: Maximum number of IPC connections that can connect to the Altibase server at the same time</span></p></li></ul><h3 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-Semaphore"><span class="md-plain">Semaphore</span></h3><p class="md-end-block md-p"><span class="md-plain">This is a kind of IPC resource like shared memory. The difference is the shared memory is provided as a way to shared data between processes, while semaphores are resources provided by the operating system as a way to implement synchronization between processes.</span></p><p class="md-end-block md-p"><span class="md-plain">Synchronization means that only one process can access and change a specific resource or object at a time (unlike mutex, an inquiry is possible at the same time).</span></p><p class="md-end-block md-p"><span class="md-plain">As described above, Altibase uses shared memory as a communication buffer between both ends when the Altibase server and client exist in the local server. At this time, it is necessary to control the concurrency of the memory. (Because the user should not write at the same time)</span></p><p class="md-end-block md-p"><span class="md-plain">In this case, a semaphore operation occurs to control access to read/write access to memory.</span></p><p class="md-end-block md-p"><span class="md-plain">Depending on the semaphore operation, the process can go into a waiting state or a progress state. Since these semaphore operations occur simultaneously, it is necessary to set the appropriate number of semaphores and kernel parameters for the operation.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">The kernel parameters related to semaphores in a typical Unix system are as follows.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span md-focus"><span class="md-plain md-expand">Kernel Parameter</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmni</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of semaphore sets in the system. 84 bytes of kernel memory are allocated per set</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5029</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmns</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of semaphores in the system, with 16 bytes of kernel memory allocated</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">8192</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmsl</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of semaphores in a set of semaphores and must be logically less than or equal to semmns</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">If set too large, several semaphore IDs can monopolize the entire system semaphore.</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">2000</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmnu</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of undo structures in the system</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">1024</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">semume</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of undo entries per process</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">512</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">semvmx</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum value of one semaphore</span></span></td><td class="confluenceTd"><span class="td-span md-focus"><span class="md-plain md-expand">32767</span></span></td></tr></tbody></table></div><ul class="ul-list"><li class="md-list-item md-focus-container"><p class="md-end-block md-p md-focus"><span class="md-plain md-expand">IPC_CHANNEL_COUNT: The maximum number of IPC connections that can connect to the Altibase server at the same time</span></p></li></ul><h3 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-FileCache"><span class="md-plain">File Cache </span></h3><p class="md-end-block md-p">This kernel parameter is not required to be changed, but it suppresses the requirement of swap out the memory area used by Altibase by setting the appropriate file cache. It is also recommended because the disk I/O latency of the operating system layer due to swapping leads to Altibase's performance degradation.</p><p class="md-end-block md-p"><span class="md-plain">File cache is a kind of system buffer managed at the operating system level to solve the bottleneck caused by the speed difference between main memory device and auxiliary memory device. These file caches are managed by unique policies of each operating system. But commonly have a direct correlation with the swap policy.</span></p><p class="md-end-block md-p"><span class="md-plain">Swapping itself has the usefulness of handling applications or data files larger than main memory, but in systems where long-term resident applications such as DBMS are operated, the disk I/O delay of the operating system layer due to swappdbc_min_pcting since the response time of the DBMS may be irregular or delayed with time. So file cache is a consideration factor depending on the system use.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">Therefore, in order to guarantee Altibase's consistent response time, it is recommended to set file cache and swap-related kernel parameters in advance so that swap does not occur as much as possible.</span></p><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-ConfigurationonHPUX"><span class="md-plain">Configuration on HPUX</span></h4><p class="md-end-block md-p"><span class="md-plain">It is recommended to adjust the file cache through the kernel parameters below.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Kernel Parameter</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">dbc_min_pct</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Limits the minimum size of the file cache to a percentage of total memory. The default value is 5%. <br />Since HPUX 11.31, the name is changed to filecache_min.</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5%</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">dbc_max_pct</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Limits the maximum size of the file cache to a percentage of total memory. The default value is 50%. Since HPUX 11.31, the name is changed to filecache_max.</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5~20%</span></span></td></tr></tbody></table></div><p class="md-end-block md-p"><span class="md-plain md-expand"><span>For reference, HP's recommendation for dbc_max_pct is 20% for systems with 8 GB or less physical memory and 10% for systems with 8 GB or more, so refer to it.</span></span></p><h3 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-ResourceLimitation"><span class="md-plain md-expand">Resource Limitation</span></h3><p class="md-end-block md-p"><span class="md-plain">In the case of HPUX, some of the resource limit items are set through the following kernel parameter changes, not the user configuration file set using the ulimit, which is commonly used.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Kernel Parameter</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxdiz</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The sum of allocable data segments by one 32-bit process</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">2 GB</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxdsiz_64bit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The sum of allocable data segments by one 64-bit process</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">1 TB</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">Up to 4 TB</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> <br /></span><span class="md-plain">Considering the maximum size of the predicted Altibase process</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">max_thread_proc</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of threads a process can have</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">600 or more</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxfiles</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of files that a process can open simultaneously (soft-limit)</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">Can be increased to maxfiles_lim (hard-limit).</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">2048 or more</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">nproc</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of processes in the system</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">6142</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxusers</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Default values of nproc, callout, ninode, and file</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">124</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> <br /></span><span class="md-plain">Only under 11.23</span></span></td></tr></tbody></table></div><p class="md-end-block md-p md-focus"><span class="md-plain">In the case of “maxusers”, since HPUX 11.23 has disappeared, it is not necessary to consider it in HPUX 11.23 or later. In HPUX 11.23 and below, instead of setting “nproc” directly, setting “maxusers” to 124 is replaced.</span></p><h3 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-HowtoChange"><span class="md-plain">How to Change</span></h3><p class="md-end-block md-p"><span class="md-plain">In the case of HPUX, the Tunable kernel parameter utility (kmtune in HPUX 11.11, kctune is mainly used in HPUX 11.23 or later) or the utility called sam, which can change all kernel parameters in the system, is mainly used to modify kernel parameters. Here is an example of using kctune.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">Generally, the user needs to connect with the root account, and it is recommended to restart the system after changing to properly apply when the kernel parameters applied in real-time.</span></p><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-SharedMemory.1"><span class="md-plain md-expand">Shared Memory</span></h4><p class="md-end-block md-p"><span class="md-plain">If there was no separate configuration before, the user can change shmmni and shmseg by changing kernel parameters related to shared memory.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">Shared memory change example</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ kctune shmmni=500
$ kctune shmseg=200</pre>
</div></div><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-Semaphore.1"><span class="md-plain">Semaphore</span></h4><p class="md-end-block md-p"><span class="md-plain">If there was no separate setting before, the user can change only semmns, semmni, semmnu, and semume by changing kernel parameters related to semaphores.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">Semaphore change example</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ kctune semmns=8192
$ kctune semmni=5029
$ kctune semmnu=1024
$ kctune semume=512</pre>
</div></div><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-FileCache.1"><span class="md-plain">File Cache</span></h4><p class="md-end-block md-p"><span class="md-plain">For dbc_max_pct, according to HP's recommendation, 20% is recommended for systems with 8 GB or less physical memory, and 10% for systems with 8 GB or more.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">Example of file cache change</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ kctune dbc_min_pct=5
$ kctune dbc_max_pct=10
Or
$ kctune filecache_min=5%
 
$ kctune filecache_max=10%</pre>
</div></div><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-ResourceLimitation.1"><span class="md-plain">Resource Limitation</span><span class="md-tab"> </span></h4><p class="md-end-block md-p"><span class="md-plain">The method to change the kernel parameters related to the resource limit mentioned above is as follows.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">Example of changing resource limits</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ kctune maxdsiz=2147483648
$ kctune maxdsiz_64bit=4396972765184
$ kctune max_thread_proc=600
$ kctune maxfiles=2048
$ kctune nproc=6142</pre>
</div></div><p class="md-end-block md-p md-focus"><span class="md-plain md-expand">In HPUX 11.23 and below, &quot;nproc&quot; is not set directly, but &quot;maxusers&quot; is set to 124.</span></p><div><span class="md-plain md-expand"><br /></span><h2 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-UserSettings"><span class="md-plain">User Settings</span></h2><p class="md-end-block md-p"><span class="md-plain">This section describes resource limits, environment variables, and various environment settings of user accounts in the system for operating Altibase in the HPUX operating system.</span></p><p class="md-end-block md-p"><span class="md-plain">Refer to the guide provided by HP for specific commands and specifics related to configuration.</span></p><h3 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-ResourceLimitation.2"><span class="md-plain">Resource Limitation</span></h3><p class="md-end-block md-p md-focus">In the UNIX operating system, logical limits are set for available resources on a user account basis. Among the resource limit items, the items that need to be expanded for stable service operation as follows.</p></div><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Item</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">virtual memory (memory)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of available virtual memory</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">open files (nofiles)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of files that can be accessed simultaneously by one process<br /></span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">max user process</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The number of processes that can be created per user</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">max memory size (rss)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of available memory</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">file size (fsize)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of files that can be created</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">data seg size(data)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of one process data area</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr></tbody></table></div><p class="md-end-block md-p md-focus"><span class="md-plain">The resource limit change is to proactively remove problems that may occur due to logical limitations even when there is a lot of physical resources when expanding the memory and data file area used by a specific user. It is recommended to set as unlimited as possible.</span></p><p class="md-end-block md-p"><span class="md-plain">For example, the meaning of open files includes the number of communication sockets as well as the files accessed by the process, so the maximum number of concurrent clients, the number of data files used simultaneously, the number of redo log files, and the number of trace log files must be considered.</span></p><p class="md-end-block md-p"><span class="md-plain">To change the method, edit the environment configuration file using the ulimit command, edit the system resource configuration file, or use the kernel-related utilities provided for each operating system.</span></p><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-Hard-Limit&amp;Soft-Limit"><span class="md-plain">Hard-Limit &amp; Soft-Limit</span></h4><p class="md-end-block md-p"><span class="md-plain">Resource limit values are divided into the concept of hard-limit and soft-limit.</span></p><p class="md-end-block md-p"><span class="md-plain">The hard-limit means the maximum value of the kernel-wide resource limit that cannot be changed except the root account, and the soft-limit means that the current user account can change up to the hard-limit. (Refer to the ulimit –S / -H option for details.)</span></p><p class="md-end-block md-p"><span class="md-plain">The soft-limit is effective while the user maintains a session by accessing it, and changes are immediately reflected. However, if other sessions of the same user account are connected, the existing soft-limit is reflected, so it is recommended to add the ulimit command to the user account configuration file.</span></p><p class="md-end-block md-p"><span class="md-plain">However, this method may not be intended due to the global hard-limit, so it is recommended to systematically apply it through editing system-wide resource configuration files rather than applying user account units using environment configuration files.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">However, since HPUX does not have a system-wide resource configuration file, sam or kctune is used to change the hard-limit for resource limitation.</span></p><h3 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-EnvironmentVariables"><span class="md-plain">Environment Variables</span></h3><p class="md-end-block md-p"><span class="md-plain">The environment variables that must be set are as follows. Set the following environment variables in the environment configuration file of the user account according to the user's shell syntax.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Environment Variable</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">ALTIBASE_HOME</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Specifies the path where Altibase is installed.</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">PATH</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain"><span>Specifies the path where </span>Altibase's utilities and shell scripts. Adds ALTIBASE_HOME/bin.</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">LD_LIBRARY_PATH</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain"><span>Specifies the path where </span>Altibase's dynamic library. Adds ALTIBASE_HOME/lib.</span></span></td></tr></tbody></table></div><p class="md-end-block md-p"><span class="md-plain">In addition, the following environment variables that exist only in HPUX must be added.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Environment Variable</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain md-expand">Description</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">SHLIB_PATH</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Adds ALTIBASE_HOME/lib. Set when linking a dynamic library with 32 bits.</span></span></td></tr></tbody></table></div><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-SettingsforMulti-threadedApplication(1)"><span class="md-plain">Settings for Multi-threaded Application (1)</span></h4><p class="md-end-block md-p"><span class="md-plain">For Altibase, a multi-thread-based application program, a separate environment variable setting is required. For reference, this document mentions only representative ones, and it should be noted that all multi-thread-related environment variables supported by HPUX need to be considered.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain md-expand">All of the elements below are essential. Among them, the environment variable PTHREAD_FORCE_SCOPE_SYSTEM related to the MxN thread model must be set.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Environment Variable</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Remark</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">PTHREAD_FORCE_SCOPE_SYSTEM</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Set the thread contention area as the system</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Supported in HPUX 11.23 or later</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">PERF_ENABLE</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Omit part of user-space sleep queue operation</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">HPUX 11.23 only</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">PTHREAD_FAST_SHARED_OBJECTS</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Application of the private algorithm to shared objects</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Supported in HPUX 11.31 or later</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">PTHREAD_DISABLE_HANDOFF</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Application of multiple CPU environment</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Supported in HPUX 11.23 or later</span></span></td></tr></tbody></table></div><p>For PERF_ENABLE, from HPUX 11.31 onwards, it is included in PTHREAD_FORCE_SCOPE_SYSTEM and is not considered in HPUX 11.31 or later.</p><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-SettingsforMulti-threadedApplication(2)"><span class="md-plain md-expand">Settings for Multi-threaded Application (2)</span></h4><p class="md-end-block md-p"><span class="md-plain">It is mentioned that this is also a tunable element that cannot provide a recommended value as a setting for a multi-thread-based application, or something to be considered in the initial stage.</span></p><p class="md-end-block md-p"><span class="md-plain">In an operating system that uses only one memory allocation area to request memory for a specific process, when multiple threads of a multi-threaded application program concurrently request memory (malloc, free), contention due to a lock operation occurs, resulting in performance degradation.</span></p><p class="md-end-block md-p"><span class="md-plain">To solve this problem, HPUX provides up to 64 memory allocations per process, called arenas, to distribute threads between arenas to reduce lock contention caused by memory request.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">It can be set with the following environment variables.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Environment Variable</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Remark</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">_M_ARENA_OPTS=x:y</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">x: The number of arenas to be allocated per process. The default value is 8. [Range: 1-64]</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-br md-tag" style="color: rgb(167,167,167);"> <br /></span><span class="md-plain">y: The expansion unit of the arena, expressed as the number of memory pages. The default is 32. [Range: 1-4096]</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The larger the number of arenas (x), the more the system memory usage increases, and the smaller the performance of the Altibase decreases, so it is necessary to set the appropriate number.</span></span></td></tr></tbody></table></div><p class="md-end-block md-p md-focus"><span class="md-plain">Generally, if it is not a multi-threaded application, it operates as one arena regardless of setting, and when it is set as an invalid value, it operates as a default.</span></p><p class="md-end-block md-p"><span class="md-plain">For example, if the user sets up as follows, 24 arenas are allocated to multi-threaded applications only, and each arena increases in units of 64*4KB (typical memory page size) when expanded.</span></p><p class="md-end-block md-p"><span>_M_ARENA_OPTS setting example</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ export _M_ARENA_OPTS = 24:64</pre>
</div></div><p class="md-end-block md-p md-focus"><span class="md-plain">In general, the higher the number of threads in an application program, the higher the number of arenas to improve performance.</span></p><p class="md-end-block md-p"><span class="md-plain">However, if it is set too large, fragmentatiCompatible with data seg sizeon of the heap area may occur, and the size of the process may be too large due to the inefficient use of memory.</span></p><p class="md-end-block md-p"><span class="md-plain">For example, if there is a concern about insufficient memory due to the lack of physical memory of the system itself, in some cases, it is set to 1: 8 to operate as a single-threaded application program. If the bottleneck is related to a memory request (malloc/free), it is common to increase the value within the resource range.</span></p><h2 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-Multi-ThreadRelatedPatch"><span class="md-plain md-expand">Multi-Thread Related Patch</span></h2><p class="md-end-block md-p"><span class="md-plain">Altibase is a single process, multi-threaded application. Therefore, a multi-thread related HPUX patch is needed. Among these, 'thread library cumulative patch' has a direct effect on performance, so it must be checked whether a patch exists.</span></p><p class="md-end-block md-p"><span class="md-plain">The method to check the patch list of the current system is as follows.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">How to check multi-thread related patch</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ swlist -l patch | grep pthread
$ PHCO_38955    1.0          pthread library cumulative patch
$ PHKL_35709    1.0          pthread_cond_timedwait,hires timers,callout
$ PHKL_37122    1.0          pthread_condvar_prio_boost patch</pre>
</div></div><p class="md-end-block md-p md-focus"><span>In addition to this, it is recommended to apply the latest patch to avoid various problems known from HPUX.</span></p><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-AdditionalConsiderationsWhenApplyingPHCO_33675andPHCO_34718"><span class="md-plain">Additional Considerations When Applying PHCO_33675 and PHCO_34718</span></h4><p class="md-end-block md-p"><span class="md-plain">When the patch was applied in HPUX 11.23, it was reported through HP that the application program kept the shared mutex for a longer period of time and deteriorated the performance.</span></p><p class="md-end-block md-p"><span class="md-plain">After checking the patch list, if the patch exists, the following environment variables should be added and set to 1 to restore system performance.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Environment Variable</span></span></th><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Remark</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">PTHREAD_SHARED_MUTEX_OLDSPIN</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Performance downgrade due to PHCO_33675, PHCO_34718</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Considered only on HPUX 11.23</span></span></td></tr></tbody></table></div><h2 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-Summary"><span class="md-plain">Summary</span></h2><p class="md-end-block md-p"><span class="md-plain">For stable operation of Altibase in the HPUX operating system, it is necessary to perform kernel parameter settings and user environment settings in advance. If the setting is not performed properly, it should be noted that the problem can be caused by the limited values even though there are sufficient system resources.</span></p><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-KernelParameters.1"><span class="md-plain">Kernel Parameters</span></h4><p class="md-end-block md-p md-focus"><span class="md-plain">Refer to the table below to set the kernel parameters properly. For reference, in HPUX, some of the resource limit items are adjusted by changing kernel parameters.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Classification</span></span></th><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Kernel Parameter</span></span></th><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th><th style="text-align: left;" class="confluenceTh"><span class="td-span"><span class="md-plain">Remark</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Shared memory</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">shmmni</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">500 or more</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">&gt; shmseg</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Shared memory</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">shmseg</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">200 or more</span></span></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Semaphore</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmns</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">8192</span></span></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Semaphore</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmni</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5029</span></span></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Semaphore</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmnu</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5029</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmni</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Semaphore</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">semume</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5029</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">semmni</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">File cache</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">dbc_min_pct</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5 or less</span></span></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">File cache</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">dbc_max_pct</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">20 or less</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">20% recommended for systems with 8 GB or less physical memory, 10% recommended for systems with 8 GB or more</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Resource limit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxdsiz</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">2GB</span></span></td><td class="confluenceTd">Corresponds to data seg size (32bit)</td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Resource limit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxdsiz_64bit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">1 TB / Maximum: around 4TB</span></span></td><td class="confluenceTd">Corresponds to data seg size (64bit)</td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Resource limit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxfiles</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5029 or more</span></span></td><td class="confluenceTd">Corresponds to open files</td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Resource limit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">max_thread_proc</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">5029 or more</span></span></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Resource limit</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">nproc</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">6142</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Corresponds to max user process</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> <br /></span><span class="md-plain">&gt;= semmnu + 4</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">Resource limite</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxusers</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">124</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">Not available starting in HPUX 11.23</span></span></td></tr></tbody></table></div><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-UserResourceLimitation"><span class="md-plain">User Resource Limitation</span></h4><p class="md-end-block md-p"><span class="md-plain">Please refer to the table below and set it as unlimited as possible.</span></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><span class="td-span"><span class="md-plain">Classification</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Description</span></span></th><th class="confluenceTh"><span class="td-span"><span class="md-plain">Recommended Value</span></span></th></tr></thead><tbody><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">data set size (data)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of process data area</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxdsiz</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">maxdsiz_64bit</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">file size</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of created file</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">open files (no files)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum number of files that can be accessed by more process at the same time</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">maxfiles</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">max memory size (rss)</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The maximum size of available memory</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">unlimited</span></span></td></tr><tr><td class="confluenceTd"><span class="td-span"><span class="md-plain">max user process</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">The number of processes that can be created per user</span></span></td><td class="confluenceTd"><span class="td-span"><span class="md-plain">nproc</span><span class="md-br md-tag" style="color: rgb(167,167,167);"> </span><span class="md-plain">unlimited</span></span></td></tr></tbody></table></div><h4 class="md-end-block md-heading" id="HPUXSetupGuideforAltibase-UserEnvironmentVariables"><span class="md-plain">User Environment Variables</span></h4><p class="md-end-block md-p"><span class="md-plain">In the case of sh, bash, ksh, examples of setting required environment variables using the environment setting file are as follows. In the case of csh, it is set through a shell command such as setenv instead of export.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">User environment variable setting example</span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;"># For Multi-Threaded Applications
PTHREAD_FORCE_SCOPE_SYSTEM=ON; export PTHREAD_FORCE_SCOPE_SYSTEM;
PTHREAD_FAST_SHARED_OBJECTS=ON; export PTHREAD_FAST_SHARED_OBJECTS;
PTHREAD_DISABLE_HANDOFF=ON; export PTHREAD_DISABLE_HANDOFF;
PERF_ENABLE=1; export PERF_ENABLE;
_M_ARENA_OPTS=8:32; export _M_ARENA_OPTS;
 
# For Altibase
ALTIBASE_HOME=/ALTIBASE; export ALTIBASE_HOME;
PATH=$ALTIBASE_HOME/bin:$PATH; export PATH;
ALTIBASE_NLS_USE=MS949; export ALTIBASE_NLS_USE;
SHLIB_PATH=$ALTIBASE_HOME/lib:$SHLIB_PATH; export SHLIB_PATH; # For 32bit
LD_LIBRARY_PATH=$ALTIBASE_HOME/lib:$LD_LIBRARY_PATH; export LD_LIBRARY_PATH; # For 64bit
 
# For Resource Limitation
ulimit –f unlimited  # file size, fsize
ulimit -m unlimited  # max memory size, rss</pre>
</div></div><p class="md-end-block md-p"><span class="md-plain">For reference, in the case of ksh, an error may occur when defining another environment variable using the environment variable without the environment variable being predefined.</span></p><p class="md-end-block md-p"><span class="md-plain">In the above example, “_M_ARENA_OPTS” is simply a default value, and should be properly set according to the system. For details, refer to “Configuration for Multi-threaded Application (2)” in the [Environment Variables] section.</span></p><p class="md-end-block md-p md-focus"><span class="md-plain">In addition, refer to &quot;Additional consideration when applying PHCO_33675 and PHCO_34718&quot; in the [Multi-thread related patches] section.</span></p><p class="md-end-block md-p"><span class="md-plain"><br /></span></p><p class="md-end-block md-p"><span class="md-plain"><br /></span></p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 23, 2021 09:49</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
